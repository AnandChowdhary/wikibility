var app=angular.module("wikibility",["ngRoute"]);app.config(function(t,e){t.when("/",{templateUrl:"home.html",controller:"homeCtrl"}).when("/wiki/:slug",{templateUrl:"article.html",controller:"articleCtrl"}),e.html5Mode(!0)}),app.factory("wikiService",function(t,e){var a={query:function(a){var r="https://en.wikipedia.org/w/api.php?action=parse&prop=text&page="+a.q+"&format=json&section="+a.section,n=e.trustAsResourceUrl(r);return t.jsonp(n,{jsonpCallbackParam:"callback"})},nSections:function(a){var r="https://en.wikipedia.org/w/api.php?action=parse&page="+a.q+"&prop=sections&format=json",n=e.trustAsResourceUrl(r);return t.jsonp(n,{jsonpCallbackParam:"callback"})}};return a}),app.controller("homeCtrl",function(t,e){t.searchArticle=function(){e.path("/wiki/"+t.searchModel.replace(/ /g,"_"))}}),app.controller("articleCtrl",function(t,e,a,r,n){r.query({q:e.slug,section:0}).then(function(e){t.wikiTitle=e.data.parse.title,t.wikiData=a.trustAsHtml(e.data.parse.text["*"]),n(function(){angular.element("sup").each(function(){$(this).html($(this).html().replace("[","").replace("]",""))})},1)}),t.sectionsArray=[],r.nSections({q:e.slug}).then(function(a){console.log(a.data.parse.sections);for(var n=0,i=0;i<a.data.parse.sections.length-1;i++)1===a.data.parse.sections[i].toclevel&&(n++,t.sectionsArray.push({id:n,title:a.data.parse.sections[i].line,text:"Sample text"}));for(var o=0,s=0;s<t.sectionsArray.length;s++){var l=s;r.query({q:e.slug,section:t.sectionsArray[s].id}).then(function(e){var a=e.data.parse.text["*"];a=a.split("mw-headline")[1],a=a.split(">")[1],a=a.split("<")[0];for(var r=0;r<t.sectionsArray.length;r++)t.sectionsArray[r].title===a&&(t.sectionsArray[r].text=e.data.parse.text["*"],o++,o===t.sectionsArray.length&&console.log(t.sectionsArray))})}})});
//# sourceMappingURL=./app-min.js.map